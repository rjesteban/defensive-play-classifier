import json
from playbyplay.utils import find_index

"""
games = {"0021500149": [33, 46, 83, 88, 90, 97, 137, 157, 188, 200, 205,
                        206, 215, 269, 279, 294, 302, 328, 342, 364, 371,
                        382, 394, 396, 434, 456, 475, 477, 500, 540, 550, 552],
         "0021500197": [2, 7, 10, 34, 39, 56, 68, 78, 87, 89, 101, 128, 131,
                        174, 184, 199, 201, 224, 235, 290, 336, 374, 394, 398,
                        436, 443, 456, 458, 467, 471, 472, 482, 499],
         "0021500270": [9, 26, 40, 111, 116, 127, 164, 172, 194, 227, 236,
                        244, 295, 306, 311, 317, 324, 351, 355, 372, 422, 426,
                        427, 449, 477, 479, 496, 514, 556, 564, 565, 567, 595],
         "0021500316": [22, 48, 66, 73, 82, 114, 121, 123, 136, 139, 141, 145,
                        169, 176, 190, 201, 249, 254, 257, 264, 296, 324, 326,
                        381, 411, 420, 425, 443],
         "0021500350": [8, 14, 17, 21, 29, 46, 55, 141, 169, 176, 191, 225,
                        250, 292, 305, 319, 324, 370, 421, 429, 444,
                        450, 485, 512, 536],
         "0021500428": [12, 24, 60, 65, 86, 99, 100, 103, 130, 137, 167, 179,
                        244, 257, 264, 278, 281, 305, 306, 328, 330, 341, 388,
                        395, 456, 499, 520],
         "0021500476": [2, 9, 16, 26, 27, 36, 41, 51, 62, 69, 85, 86, 94, 107,
                        109, 124, 141, 143, 163, 189, 235, 241, 255, 265, 312,
                        329, 332, 377, 383, 411, 453, 490, 505],
         "0021500582": [106, 118, 141, 149, 153, 188, 280, 312, 452, 457, 503,
                        525, 528, 541, 543, 551, 562, 572, 574, 577]
         }
"""

""" EXEMPTED EIDS
games = {"0021500316": [322, 324, 338, 377, 462],
         "0021500350": [393, 450, 496, 520, 523],
         "0021500428": [411, 428, 441, 502],
         "0021500476": [278],
         "0021500582": [26, 364, 407],
         "0021500149": [205, 215, 279, 475, 477, 540, 550],
         "0021500270": [477],
         "0021500316": [254],
         "0021500428": [24, 130, 305, 328, 341],
         "0021500582": [503, 541]
         }
"""

# get time here

games = {
    "0021500149": [2, 4, 15, 28, 31, 32, 41, 42, 67, 72, 81, 86, 95, 110, 112, 118, 166, 172, 175, 183, 198, 202, 208, 216, 218, 222, 224, 237, 249, 298, 312, 318, 322, 323, 347, 354, 381, 404, 409, 422, 425, 428, 433, 436, 440, 445, 449, 473, 499, 527],
    "0021500197": [38, 44, 46, 48, 50, 65, 108, 124, 126, 134, 137, 138, 146, 159, 162, 172, 175, 189, 203, 205, 229, 230, 248, 250, 260, 268, 291, 296, 328, 348, 369, 373, 376, 388, 407, 429, 431, 448, 465, 469, 474, 481, 487, 500, 513],
    "0021500270": [6, 11, 15, 27, 42, 68, 70, 82, 94, 105, 108, 110, 113, 118, 131, 133, 140, 152, 173, 176, 214, 245, 247, 254, 256, 298, 299, 309, 314, 316, 326, 341, 353, 361, 362, 365, 370, 413, 428, 437, 457, 458, 518, 545, 547, 559, 573, 593, 598, 605, 625],
    "0021500316": [2, 4, 31, 41, 89, 90, 144, 164, 168, 173, 183, 187, 188, 205, 209, 215, 216, 224, 233, 242, 244, 266, 275, 292, 314, 316, 329, 340, 343, 352, 353, 372, 400, 406, 415, 424, 430, 432, 438, 439, 440, 444, 459, 460, 469, 471, 483, 486, 489],
    "0021500350": [5, 13, 16, 22, 31, 33, 57, 80, 86, 95, 96, 98, 106, 123, 137, 143, 182, 189, 194, 205, 214, 215, 227, 229, 230, 248, 252, 264, 284, 286, 303, 306, 309, 322, 343, 368, 389, 393, 410, 417, 448, 454, 484, 490, 520, 569],
    "0021500428": [3, 5, 16, 29, 59, 63, 73, 101, 104, 119, 123, 132, 133, 168, 190, 197, 202, 203, 205, 220, 221, 247, 261, 298, 300, 316, 340, 346, 353, 355, 367, 369, 372, 373, 381, 391, 394, 400, 411, 413, 414, 432, 436, 438, 457, 473, 482, 488, 493],
    "0021500476": [7, 10, 22, 46, 71, 73, 110, 121, 132, 133, 160, 178, 179, 194, 206, 215, 216, 217, 239, 259, 274, 301, 315, 316, 319, 328, 346, 355, 367, 369, 380, 382, 397, 412, 422, 428, 437, 441, 448, 454, 463, 476, 484, 486, 498, 553],
    "0021500582": [4, 6, 13, 17, 26, 31, 32, 33, 46, 48, 53, 67, 70, 71, 77, 83, 154, 171, 217, 253, 257, 258, 277, 321, 326, 329, 331, 346, 353, 364, 380, 395, 397, 399, 407, 409, 411, 434, 439, 479, 481, 486, 498, 508, 513, 526, 539, 560, 573],
}

output = open("data/actions/manids.txt", 'w')
for gid in sorted(games.keys()):
    data = json.load(open("data/pbp/" + gid + "pbp.json"))
    eids = games[gid]
    print("*" * 10) + ' "' + gid + '" ' + ("*" * 10)
    # output.write(("*" * 10) + ' "' + gid + '" ' + ("*" * 10) + "\n")
    for eid in eids:
        try:
            index = find_index(data, eid)
            row = data['resultSets'][0]['rowSet'][index]
            print(str(row[1]) + "\t" + str(row[6]) + "\t" + str(row[4]))
            # output.write(str(row[1]) + "\t\t" + str(row[6]) +
            #             "\t" + str(row[4]) + "\tn\n")
        except Exception as e:
            print "INDEX NOT FOUND FOR EID: " + str(eid)
output.close()


"""
PATH = "data/actions/"
gameids = ["0021500149", "0021500197", "0021500270", "0021500316",
           "0021500350", "0021500428", "0021500476", "0021500582"]

games = 0
ekeys = [json.load(open(PATH + gameids[i] + ".json"))
         for i in range(len(gameids))]
for index, ekey in enumerate(ekeys):
    print ("*" * 20) + str(gameids[index] + ("*" * 20))
    data = json.load(open("data/pbp/" + gameids[index] + "pbp.json"))
    for eid in sorted(ekey.keys()):
        try:
            index = find_index(data, eid)
            row = data['resultSets'][0]['rowSet'][index]
            print (str(row[1]) + "\t" + str(row[6]) + "\t" + str(row[4]))
            # output.write(str(row[1]) + "\t\t" + str(row[6]) +
            #             "\t" + str(row[4]) + "\tn\n")
        except Exception as e:
            print "INDEX NOT FOUND FOR EID: " + str(eid)
print games
"""
